Фискализация для клиентов Robokassa
Для клиентов Robokassa выбравших для себя Облачное решение, Кассовое решение или решение Робочеки, в протокол добавляется дополнительный параметр.

В соответствии с требованием Закона РФ, все без исключения операции с использованием электронных средств платежа должны проходить через специализированную контрольно-кассовую технику, и данные о них должны передаваться через операторов фискальных данных в налоговую инспекцию в режиме реального времени.

Передача фискальных данных при использовании официальных виджетов и модулей оплаты:
Вам необходимо выполнить простые настройки модуля на стороне сайта. Это встроенная функция, после ее настройки вся необходимая информация для чека будет передаваться из карточек товара вашего интернет-магазина (актуально для официальных модулей для Битрикс24, InSales, WordPress WooCommerce, OpenCart, Joomla, VirtueMart, 1С-Битрикс).

WIX: товарная номенклатура передаётся по умолчанию, без каких-либо дополнительных настроек.

Amo CRM: необходимо выполнить настройку модуля во вкладке "Настройки платежа" и включить фискализацию чеков, после чего наименования товаров и услуг будут передаваться в чек из счёта, который будет создан в новой сделке.

МойСклад: необходимо выполнить настройку модуля во вкладке "Платежи" и включить фискализацию чеков. После этого наименования товаров и услуг будут передавать в чек из счёта, который будет создан во вкладке "Счета покупателям".

Передача номенклатуры при использовании виджетов и модулей оплаты сторонних разработчиков:
Если у вас используется готовая интеграция под платформу сайта от сторонних разработчиков, такая функция есть в настройках модуля/виджета - или отсутствует полностью, и ее невозможно будет добавить. Необходимо внимательно ознакомиться с настройками на стороне вашего сайта, либо уточнить информацию о настройке передачи номенклатуры у разработчиков данного модуля/виджета.

Инструкции по настройке передачи номенклатуры для популярных CMS

Передача номенклатуры в рамках «самописного» сайта:
Если вы разрабатываете сайт самостоятельно, то передача номенклатуры осуществляется посредством передачи дополнительного параметра в запросе на проведение платежа.

Обращаем Ваше внимание, что для решений Робочеки и Облачное в чеке не может быть более ста товарных позиций.

Параметр —
Receipt
Формат —
Json
Передаётся вместе со всеми остальными параметрами для инициализации платежа, а так же этот параметр, если передаётся, обязательно должен быть включен в подсчёт контрольной суммы.

В этом параметре передается информация о перечне товаров/услуг, количестве, цене, налоговой ставке и ставке НДС по каждой позиции.

Внимание!
Отсутствие номенклатуры в чеке является нарушением ФЗ-54.

Параметр включается в контрольную подпись запроса после номера счета магазина.

Например: MerchantLogin:OutSum:InvId:Receipt:Пароль#1
В связи с тем, что значение этого параметра может иметь большую длину, мы рекомендуем передавать запросы с этим параметром только методом POST, во избежание превышения максимальной длины строки запроса.

Значение параметра Receipt перед использованием в строке для подсчета контрольной суммы и отправкой его формой необходимо URL-кодировать.

Пример передаваемого кода
Json


1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23

              
        {
          "sno":"osn",
          "items": [
            {
              "name": "Название товара 1",
              "quantity": 1,
              "sum": 100,
              "payment_method": "full_payment",
              "payment_object": "commodity",
              "tax": "vat10"
            },
            {
              "name": "Название товара 2",
              "quantity": 3,
              "sum": 450,
              "cost": 150,			  
              "payment_method": "full_prepayment",
              "payment_object": "service",
              "tax": "vat10",
              "nomenclature_code": "04620034587217"
            }
          ]
        }
              
            

развернуть
Описание параметров

Параметр

Значение

sno
Система налогообложения. Необязательное поле, если у организации имеется только один тип налогообложения. (Данный параметр обязательно задается в личном кабинете магазина)

Применяется со значениями:

osn
– Общая СН

usn_income
– Упрощенная СН (доходы)

usn_income_outcome
– Упрощенная СН (доходы минус расходы)

esn
– Единый сельскохозяйственный налог

patent
– Патентная СН

items
Массив данных о позициях чека

sum
Обязательное поле. Полная сумма в рублях за итоговое количество данного товара с учетом всех возможных скидок, бонусов и специальных цен. Десятичное положительное число: целая часть не более 8 знаков, дробная часть не более 2 знаков.

cost
Необязательное поле. Полная сумма в рублях за единицу товара с учетом всех возможных скидок, бонусов и специальных цен. Десятичное положительное число: целая часть не более 8 знаков, дробная часть не более 2 знаков. Параметр можно передавать вместо параметра sum.При передаче параметра общая сумма товарных позиций рассчитывается по формуле (cost*quantity)=sum.

name
Обязательное поле. Наименование товара. Строка, максимальная длина 128 символа. Если в наименовании товара Вы используете специальные символы, например кавычки, то их обязательно необходимо экранировать.

quantity
Обязательное поле. Количество товаров.

payment_method
Признак способа расчёта. Этот параметр необязательный. Если этот параметр не передан клиентом, то в чеке будет указано значение параметра по умолчанию из Личного кабинета.

Применяется со значениями:

full_prepayment
Предоплата 100%. Полная предварительная оплата до момента передачи предмета расчёта

prepayment
Предоплата. Частичная предварительная оплата до момента передачи предмета расчёта

advance
Аванс

full_payment
Полный расчёт. Полная оплата, в том числе с учетом аванса (предварительной оплаты) в момент передачи предмета расчёта

partial_payment
Частичный расчёт и кредит. Частичная оплата предмета расчёта в момент его передачи с последующей оплатой в кредит

credit
Передача в кредит. Передача предмета расчёт без его оплаты в момент его передачи с последующей оплатой в кредит

credit_payment
Оплата кредита. Оплата предмета расчёта после его передачи с оплатой в кредит (оплата кредита)

payment_object
Признак предмета расчёта. Этот параметр необязательный. Если этот параметр не передан клиентом, то в чеке будет указано значение параметра по умолчанию из Личного кабинета.

Применяется со значениями:

commodity
Товар. О реализуемом товаре, за исключением подакцизного товара (наименование и иные сведения, описывающие товар)

excise
Подакцизный товар (наименование и иные сведения, описывающие товар)

job
Работа. О выполняемой работе (наименование и иные сведения, описывающие работу)

service
Услуга. Об оказываемой услуге (наименование и иные сведения, описывающие услугу)

gambling_bet
Ставка азартной игры. О приеме ставок при осуществлении деятельности по проведению азартных игр

gambling_prize
Выигрыш азартной игры. О выплате денежных средств в виде выигрыша при осуществлении деятельности по проведению азартных игр

lottery
Лотерейный билет. О приеме денежных средств при реализации лотерейных билетов, электронных лотерейных билетов, приеме лотерейных ставок при осуществлении деятельности по проведению лотерей

lottery_prize
Выигрыш лотереи. О выплате денежных средств в виде выигрыша при осуществлении деятельности по проведению лотерей

intellectual_activity
Предоставление результатов интеллектуальной деятельности. О предоставлении прав на использование результатов интеллектуальной деятельности или средств индивидуализации

payment
Платеж. Об авансе, задатке, предоплате, кредите, взносе в счет оплаты, пени, штрафе, вознаграждении, бонусе и ином аналогичном предмете расчета

agent_commission
Агентское вознаграждение. О вознаграждении пользователя, являющегося платежным агентом (субагентом), банковским платежным агентом (субагентом), комиссионером, поверенным или иным агентом

composite
Составной предмет расчета. О предмете расчета, состоящем из предметов, каждому из которых может быть присвоено значение выше перечисленных признаков

resort_fee
Курортный сбор

another
Иной предмет расчета. О предмете расчета, не относящемуся к выше перечисленным предметам расчета

property_right
Имущественное право

non-operating_gain
Внереализационный доход

insurance_premium
Страховые взносы

sales_tax
Торговый сбор

tovar_mark
Товар, подлежащий маркировке средством идентификации, имеющий код маркировки, за исключением подакцизного товара

tax
Обязательное поле. Это поле устанавливает налоговую ставку в ККТ. Определяется для каждого вида товара по отдельности, но за все единицы конкретного товара вместе.

Применяется со значениями:

none
– Без НДС.

vat0
– НДС по ставке 0%

vat10
– НДС чека по ставке 10%

vat110
– НДС чека по расчетной ставке 10/110

vat20
– НДС чека по ставке 20%

vat120
– НДС чека по расчетной ставке 20/120

vat5
– НДС по ставке 5%

vat7
– НДС по ставке 7%

vat105
– НДС чека по расчетной ставке 5/105

vat107
– НДС чека по расчетной ставке 7/107

nomenclature_code
Маркировка товара, передаётся в том виде, как она напечатана на упаковке товара. Параметр является обязательным только для тех магазинов, которые продают товары подлежащие обязательной маркировке. Код маркировки расположен на упаковке товара, рядом со штрих-кодом или в виде QR-кода.

Правила для успешного формирования чека
• В чеке есть хотя бы одна позиция;

• Во всех позициях указано наименование. Строка наименования не должна содержать спецсимволов и символов других языков, кроме русского и английского;

• Входная строка наименования товара длиной не более 128 символов, более длинные строки будут обрезаны;

• Цена и сумма позиции не отрицательная;

• Общая сумма всех позиций больше нуля;

• Сумма каждой позиции должна передаваться в рублях за все количество данного товара с учетом всех возможных скидок, бонусов и специальных цен;

• Сумма всех позиций в чеке должна быть равна сумме операции;

• Все телефоны в личном кабинете должны указываться в формате «+Ц», где Ц – последовательность цифр. Максимум 18 цифр, без скобок и дефисов;

• Наименование организации не должно содержать спецсимволов и символов других языков, кроме русского и английского;